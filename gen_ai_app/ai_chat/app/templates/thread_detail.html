<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thread Detail</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Thread Detail</h1>
        <div id="thread-detail">
            <!-- Thread details will be dynamically loaded here -->
        </div>
        <button class="btn btn-secondary mt-3" onclick="goBack()">Back to Threads</button>
    </div>

    <script>
        async function fetchThreadDetail(threadId) {
            const response = await fetch(`/threads/${threadId}`);
            const thread = await response.json();

            const threadDetail = document.getElementById('thread-detail');
            threadDetail.innerHTML = '';

            if (thread.message) {
                threadDetail.innerHTML = `<p>${thread.message}</p>`;
                return;
            }

            threadDetail.innerHTML = `
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">${thread.summary}</h5>
                        <p class="card-text">${thread.content}</p>
                        <p class="card-text"><small class="text-muted">Created at: ${thread.created_at}</small></p>
                        <p class="card-text"><small class="text-muted">Updated at: ${thread.updated_at}</small></p>
                    </div>
                </div>
            `;
        }

        function goBack() {
            window.location.href = '/threads_page';
        }

        // Fetch thread detail on page load
        const urlParams = new URLSearchParams(window.location.search);
        const threadId = urlParams.get('id');
        if (threadId) {
            fetchThreadDetail(threadId);
        } else {
            document.getElementById('thread-detail').innerHTML = '<p>Invalid thread ID.</p>';
        }
    </script>
</body>
</html>
